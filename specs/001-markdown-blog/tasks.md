# Tasks: Minimal Markdown Blog

**Input**: Design documents from `/specs/001-markdown-blog/`
**Prerequisites**: plan.md, spec.md, research.md, data-model.md, contracts/frontmatter-schema.yaml, quickstart.md

**Testing Policy**: Feature-specific tests are not included (not explicitly requested in spec). However, CI automation and quality gates (typecheck, lint, build verification) are configured per technical requirements.

**Organization**: Tasks are grouped by user story to enable incremental, additive delivery. Each story builds on previous work without breaking existing functionality.

## Format: `[ID] [Story] Description`

- **[Story]**: Which user story this task belongs to (e.g., US1, US2, US3, US4)
- Include exact file paths in descriptions

## Path Conventions

- Single Astro project: `src/`, `tests/`, `public/` at repository root
- Content collections: `src/content/posts/` for Markdown blog posts
- Build output: `dist/` (generated by Astro)

---

## Phase 1: Setup (Shared Infrastructure)

**Purpose**: Project initialization and basic structure

- [ ] T001 Initialize Astro project with npm create astro@latest at repository root
- [ ] T002 Install dependencies: astro@latest, typescript
- [ ] T003 Configure TypeScript in tsconfig.json (strict mode enabled)
- [ ] T004 Configure ESLint in .eslintrc.json with Astro plugin
- [ ] T005 Create .gitignore for node_modules/, dist/, .astro/, .env files
- [ ] T006 Configure Astro in astro.config.mjs (site URL, basic Markdown rendering with Shiki syntax highlighting)
- [ ] T007 Create directory structure: src/content/posts/, src/layouts/, src/components/, src/styles/, src/pages/posts/, src/pages/tags/

---

## Phase 2: Foundational (Blocking Prerequisites)

**Purpose**: Minimal core infrastructure needed to render and publish posts (User Story 1)

**‚ö†Ô∏è CRITICAL**: This phase blocks all user story work - provides the foundation for rendering Markdown posts

- [ ] T008 Define content collection schema in src/content/config.ts with Zod (title: string required, date: date required, slug: string required for published posts, description: string optional, tags: string[] default [], draft: boolean default false). Note: drafts (draft: true) may omit slug, but all published posts MUST have explicit slug in frontmatter.
- [ ] T009 Create BaseLayout component in src/layouts/BaseLayout.astro (HTML structure, head with meta tags, viewport, CSS link)
- [ ] T010 Create minimal global styles in src/styles/global.css (basic CSS reset with box-sizing and margin defaults, system font stack on body, simple hardcoded light mode colors for text/background/links, basic semantic HTML element styling for h1-h6/p/code/pre/ul/ol/blockquote)
- [ ] T011 Configure Vitest in vitest.config.ts for build verification tests
- [ ] T012 Configure GitHub Actions CI in .github/workflows/ci.yml (typecheck, lint, test, build steps)

**Checkpoint**: Minimal foundation ready - User Story 1 can now be implemented

---

## Phase 3: User Story 1 - Write and Publish a Blog Post (Priority: P1) üéØ MVP

**Goal**: Enable writers to create Markdown blog posts with frontmatter, place them in the content directory, build the site, and have posts appear on the blog with correct rendering

**Independent Test**: Create a Markdown file with frontmatter (title, date, **explicit slug**, optional description), standard Markdown elements (headings, paragraphs, bold, italic, links, lists, code blocks, blockquotes), place it in src/content/posts/, run astro build, verify it appears on homepage and renders correctly at /posts/[slug]

### Implementation for User Story 1

- [ ] T013 [US1] Create example blog post in src/content/posts/example-post.md with all required frontmatter fields (title, date, slug: "a8k3n9x2", description, tags, draft: false) and standard Markdown elements
- [ ] T014 [US1] Create draft example post in src/content/posts/draft-example.md with draft: true flag (slug optional for drafts)
- [ ] T015 [US1] Create homepage in src/pages/index.astro (query published posts with getCollection, sort by date desc, render post list)
- [ ] T016 [US1] Create PostList component in src/components/PostList.astro (display posts with title, date, description, link to post)
- [ ] T017 [US1] Create individual post page in src/pages/posts/[slug].astro (getStaticPaths for all published posts, render post content with Markdown, display metadata)
- [ ] T018 [US1] Create PostMeta component in src/components/PostMeta.astro (display title, date, tags)
- [ ] T019 [US1] Add slug uniqueness validation in src/content/config.ts (validate provided slugs are unique and alphanumeric 8-12 chars, fail build with clear error on duplicates or missing slugs for published posts)
- [ ] T020 [US1] Verify draft post exclusion: Build site and confirm draft posts do not appear in dist/ output
- [ ] T021 [US1] Verify Markdown rendering: Check all standard elements (headings, paragraphs, bold, italic, links, lists, code blocks with syntax highlighting, blockquotes) render with semantic HTML
- [ ] T022 [US1] Create Header component in src/components/Header.astro with site title only (optional polish - no navigation yet)

**Checkpoint**: User Story 1 complete and testable. Writers can publish Markdown posts with explicit slugs and see them rendered correctly. Ready to ship as MVP.

---

## Phase 4: User Story 2 - Browse and Navigate Blog Posts (Priority: P2)

**Goal**: Enable readers to view a chronological list of posts on the homepage, navigate to individual posts with clear titles/dates, and return to the homepage

**Incremental Test**: Building on US1, publish multiple posts with different dates, visit homepage, verify posts listed in reverse chronological order (newest first), click post title to navigate to full post, verify back link to homepage works

### Implementation for User Story 2

- [ ] T023 [US2] Enhance homepage index.astro with reverse chronological sorting (already implemented in US1, verify sorting by date then title)
- [ ] T024 [US2] Add navigation link in individual post page src/pages/posts/[slug].astro to return to homepage
- [ ] T025 [US2] Enhance PostList component to display post description as preview snippet if available in frontmatter
- [ ] T026 [US2] Verify navigation: Create 3+ test posts with different dates, build site, confirm homepage lists posts in correct order, click post links work, back to home link works
- [ ] T027 [US2] Enhance Header component in src/components/Header.astro with navigation links (home link, ensure clickable site title)

**Checkpoint**: User Stories 1 and 2 complete. Blog has basic publishing and navigation. Each story adds value without breaking previous functionality.

---

## Phase 5: User Story 3 - Read Posts in a Distraction-Free Environment (Priority: P3)

**Goal**: Provide clean, readable layout with optimized typography, proper line length, light/dark mode support, and responsive design for all screen sizes

**Incremental Test**: Building on US1 and US2, open a post on desktop and mobile, check typography (font size 18-20px, line height 1.6-1.8, line length 50-75 chars), toggle dark mode and verify theme persists across sessions, verify responsive layout on 320px to 4K screens

### Implementation for User Story 3

- [ ] T028 [US3] Add full typography system to global.css (optimal line length max-width: 65ch on content, font size 18-20px using clamp, line height 1.7, comfortable margins, proper vertical rhythm)
- [ ] T029 [US3] Add CSS custom properties for light/dark themes in global.css (define --color-text, --color-bg, --color-accent variables, add [data-theme="dark"] selector with dark values, ensure WCAG AA contrast ratios, replace hardcoded colors with CSS variables)
- [ ] T030 [US3] Add responsive breakpoints to global.css (media queries for mobile <768px, tablet 768-1024px, desktop >1024px, adjust font sizes and margins per breakpoint, ensure no horizontal scrolling)
- [ ] T031 [US3] Configure Shiki dual-theme syntax highlighting in astro.config.mjs (update from basic setup to dual themes: github-light for light mode, github-dark for dark mode, wrap: true for long lines)
- [ ] T032 [US3] Create ThemeToggle component in src/components/ThemeToggle.astro (light/dark mode toggle button with localStorage persistence, respect system preference via prefers-color-scheme if no stored value, add toggle to Header or BaseLayout)
- [ ] T033 [US3] Verify typography: Open post on desktop, check line length, font size, line height meet spec (50-75 chars, 18-20px, 1.6-1.8)
- [ ] T034 [US3] Verify dark mode: Toggle theme, verify localStorage persistence, reload page and confirm theme persists, check contrast ratios pass WCAG AA
- [ ] T035 [US3] Verify responsive design: Test on 320px mobile, tablet, desktop, 4K display, confirm no horizontal scrolling, readable text without zooming

**Checkpoint**: Reading experience complete. Blog has optimized typography, dark mode, and responsive design. All enhancements are additive to previous stories.

---

## Phase 6: User Story 4 - Organize Posts by Topic (Priority: P4)

**Goal**: Enable writers to categorize posts with tags in frontmatter, automatically generate tag pages, and allow readers to filter posts by tag

**Incremental Test**: Building on previous stories, add tags to post frontmatter, build site, verify post displays tags with links, click tag link to navigate to tag page, verify tag page lists all posts with that tag chronologically

### Implementation for User Story 4

- [ ] T036 [US4] Create tag page in src/pages/tags/[tag].astro (getStaticPaths to extract unique tags, filter posts by tag, render filtered post list)
- [ ] T037 [US4] Enhance PostMeta component to display clickable tag links (each tag links to /tags/[tag])
- [ ] T038 [US4] Add tag list to homepage src/pages/index.astro (optional: show all available tags with post counts)
- [ ] T039 [US4] Verify tag functionality: Create posts with tags (including posts with zero tags, posts with multiple tags), build site, verify tag pages generated, click tag links work, filtered lists correct

**Checkpoint**: All user stories complete. Blog supports full feature set from spec. Each story added value incrementally without breaking previous work.

---

## Phase 7: Polish & Cross-Cutting Concerns

**Purpose**: Improvements that affect multiple user stories, final validation, and deployment readiness

- [ ] T040 Add meta tags for SEO in BaseLayout.astro (og:title, og:description, twitter:card)
- [ ] T041 Add favicon and site metadata in public/ directory
- [ ] T042 Create Footer component in src/components/Footer.astro (copyright, minimal footer content - optional, non-MVP)
- [ ] T043 Verify build performance: Add 10+ posts, run astro build, confirm build time <5s per post increase (SC-008)
- [ ] T044 Verify accessibility: Run Lighthouse audit, confirm WCAG AA contrast ratios, semantic HTML, score ‚â•90 (SC-007, FR-012)
- [ ] T045 Verify platform independence: Copy Markdown files to different location, confirm content portable with metadata intact (SC-005)
- [ ] T046 Run full validation per quickstart.md: Execute all manual test scenarios, verify all acceptance criteria from spec.md
- [ ] T047 Create README.md with setup instructions, deployment guide, and content authoring guidelines
- [ ] T048 Optimize global.css: Remove unused styles, ensure minimal CSS bundle size
- [ ] T049 Final deployment test: Deploy to static host (Netlify, Vercel, or GitHub Pages), verify site loads <2s on 3G (SC-004)

---

## Dependencies & Execution Order

### Phase Dependencies

- **Setup (Phase 1)**: No dependencies - can start immediately
- **Foundational (Phase 2)**: Depends on Setup completion - BLOCKS all user story work
- **User Stories (Phase 3-6)**: All depend on Foundational phase completion
  - After Phase 2, user stories are implemented incrementally in priority order (P1 ‚Üí P2 ‚Üí P3 ‚Üí P4)
  - Each story builds on previous work without breaking existing functionality
- **Polish (Phase 7)**: Depends on all desired user stories being complete

### User Story Flow (Incremental Delivery)

- **User Story 1 (P1)**: Starts after Foundational - Core publishing capability - **MVP TARGET**
- **User Story 2 (P2)**: Builds on US1 - Adds navigation - Incrementally testable
- **User Story 3 (P3)**: Builds on US1+US2 - Adds reading experience polish - Incrementally testable
- **User Story 4 (P4)**: Builds on US1+US2+US3 - Adds tag organization - Incrementally testable

### Within Each User Story

- Content collection schema (T008) must be complete before any post-related tasks
- BaseLayout and minimal global.css must be ready before page implementation
- Models/utilities before services/pages
- Core implementation before verification tasks
- Story complete before moving to next priority

---

## Implementation Strategy

### MVP First (User Story 1 Only)

1. Complete Phase 1: Setup
2. Complete Phase 2: Foundational (CRITICAL - provides core infrastructure for rendering posts)
3. Complete Phase 3: User Story 1
4. **STOP and VALIDATE**: Test User Story 1 independently (create post with explicit slug, build, verify rendering)
5. Deploy/demo if ready

### Incremental Delivery

1. Complete Setup + Foundational ‚Üí Minimal foundation ready
2. Add User Story 1 ‚Üí Test incrementally ‚Üí Deploy/Demo (MVP! Writers can publish posts with explicit slugs)
3. Add User Story 2 ‚Üí Test incrementally ‚Üí Deploy/Demo (Readers can navigate posts)
4. Add User Story 3 ‚Üí Test incrementally ‚Üí Deploy/Demo (Reading experience optimized with typography, dark mode, responsive)
5. Add User Story 4 ‚Üí Test incrementally ‚Üí Deploy/Demo (Tag organization complete)
6. Each story adds value incrementally without breaking previous stories

---

## Notes

- [Story] label maps task to specific user story for traceability
- Each user story is incrementally deliverable and testable
- Feature-specific tests not included (not required by spec), but CI/build verification is configured
- Commit after each task or logical group
- Stop at any checkpoint to validate story incrementally
- Avoid: vague tasks, same file conflicts, cross-story dependencies that break incremental delivery
- **MVP slug policy**: Explicit slug REQUIRED in frontmatter for all published posts. Build-time slug generation is intentionally disallowed to guarantee URL permanence. Writers must provide alphanumeric slugs (8-12 chars, no Japanese characters) when creating posts.
- Zero tags allowed (FR-017) - ensure tag-related UI handles empty arrays
- Japanese/English/mixed filenames supported (FR-018) - slugs remain alphanumeric

---

## Key Changes from Overengineering Review

**Phase 2 (Foundational) - Reduced from 8 to 5 tasks**:
- ‚úÖ T010: Revised to **minimal CSS only** (basic reset, readable defaults, no typography system/theme variables/responsive)
- ‚ùå T011 ThemeToggle: **Removed** (moved to US3 where dark mode is specified)
- ‚ùå T012 Header: **Removed** (site title moved to US1 optional, navigation moved to US2)
- ‚ùå T013 Footer: **Removed** (moved to Phase 7 Polish as non-MVP)

**User Story 1 - Added 1 task**:
- ‚úÖ T023 (now T022): Header with site title (optional polish within US1)

**User Story 2 - Added 1 task**:
- ‚úÖ T028 (now T027): Header navigation links (required for US2 acceptance criteria)

**User Story 3 - Consolidated tasks**:
- ‚úÖ T029-T031 (now T028-T030): Full typography system, CSS custom properties, responsive breakpoints (content from old T010)
- ‚úÖ T033 (now T032): ThemeToggle creation + system preference (merged old T011 + T034)

**Phase 7 (Polish) - Added 1 task**:
- ‚úÖ T043 (now T042): Footer component (optional, non-MVP)

**Parallel planning removed**:
- ‚ùå All [P] markers removed (not actionable for solo developer MVP)
- ‚ùå "Parallel Opportunities" section removed
- ‚ùå "Parallel Example" section removed
- ‚ùå "Parallel Team Strategy" section removed

**Wording fixes**:
- ‚úÖ Testing policy clarified (CI/quality gates vs feature tests)
- ‚úÖ Shiki dual-theme consolidated (basic in T006, dual themes in T031)
- ‚úÖ "Independent" changed to "incremental/additive" throughout
- ‚úÖ Phase 2 blocking language clarified (blocks US1 vertical slice)

**MVP slug policy enforced**:
- ‚úÖ T008: Slug now REQUIRED for published posts in schema
- ‚ùå T019: Slug auto-generation utility REMOVED from MVP (explicit slugs only)
- ‚úÖ T013/T014: Example posts updated to show explicit slug requirement
- ‚úÖ T019 (renumbered from T020): Slug validation updated to validate provided slugs only
- ‚úÖ Notes section: Explicit MVP slug policy documented

**Result**: MVP (Phase 1 + Phase 2 + US1) now has 49 tasks (was 50), enforces explicit slugs for URL permanence, unblocked from US3 polish features, can ship faster with minimal foundation, and has clearer sequential execution path for solo developer with accurate incremental delivery model.
